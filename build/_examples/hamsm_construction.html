<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trp-cage haMSM Construction and Analysis &mdash; msm_we 0.1.4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Trp-cage haMSM Analysis" href="analysis.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> msm_we
          </a>
              <div class="version">
                0.1.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">msm_we</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Installation/Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#hamsm-construction-and-analysis">HAMSM Construction and Analysis</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Trp-cage haMSM Construction and Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Prep">Prep</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Model-building-with-build_analyze_model()">Model-building with build_analyze_model()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Model-building-step-by-step">Model-building step by step</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Save-model">Save model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="analysis.html">Trp-cage haMSM Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#optimization">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#westpa-integration">WESTPA Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_todos.html">TODOs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">msm_we</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../examples.html">Examples</a> &raquo;</li>
      <li>Trp-cage haMSM Construction and Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_examples/hamsm_construction.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Trp-cage-haMSM-Construction-and-Analysis">
<h1>Trp-cage haMSM Construction and Analysis<a class="headerlink" href="#Trp-cage-haMSM-Construction-and-Analysis" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://mybinder.org/v2/gh/jdrusso/msm_we/HEAD?labpath=examples%2Fhamsm_construction.ipynb"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
<p>For these examples, we’ll be constructing an haMSM from simulations of Trp-cage unfolding.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">msm_we</span> <span class="kn">import</span> <span class="n">modelWE</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ray</span>
</pre></div>
</div>
</div>
<section id="Prep">
<h2>Prep<a class="headerlink" href="#Prep" title="Permalink to this heading"></a></h2>
<p>First, let’s set some parameters for haMSM building.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h5file_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;../tests/reference/1000ns_ntl9/west.h5&#39;</span><span class="p">]</span>

<span class="c1"># Number of MSM microstates to initially put in each stratum/WE bin</span>
<span class="n">clusters_per_stratum</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">dimreduce_method</span> <span class="o">=</span> <span class="s1">&#39;pca&#39;</span>

<span class="c1"># Boundaries of the basis/target, in progress coordinate space</span>
<span class="n">pcoord_bounds</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;basis&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">]],</span>
    <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">100</span><span class="p">]]</span>
<span class="p">}</span>

<span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;NaCl Sample&#39;</span>

<span class="c1"># Reference structure</span>
<span class="n">ref_file</span> <span class="o">=</span> <span class="s1">&#39;data/2JOF.pdb&#39;</span>

<span class="c1"># WESTPA resampling time</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">1e-9</span>
</pre></div>
</div>
</div>
<section id="Define-MSM-featurization">
<h3>Define MSM featurization<a class="headerlink" href="#Define-MSM-featurization" title="Permalink to this heading"></a></h3>
<p>The function <code class="docutils literal notranslate"><span class="pre">processCoordinates</span></code> defines a transformation that’s applied to the coordinates in <code class="docutils literal notranslate"><span class="pre">auxdata/coord</span></code> before dimensionality reduction/clustering.</p>
<p>The inputs are the coordinates (read from <code class="docutils literal notranslate"><span class="pre">auxdata/coord</span></code>) for each segment in the loaded iteration(s), and it should return an array of features for each.</p>
<p>We could just use full XYZ coordinates for our MSM features. This would be a very simple (and very poor) choice – it doesn’t capture some of the translational invariance that something like pairwise distances might.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">processCoordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">modelWE</span><span class="o">.</span><span class="n">processCoordinates</span> <span class="o">=</span> <span class="n">processCoordinates</span>
</pre></div>
</div>
</div>
<p>So, let’s use pairwise distances instead, at the cost of a more expensive calculation.</p>
<p>Note that because of how work is serialized for parallelization, we have to define the <code class="docutils literal notranslate"><span class="pre">Universe</span></code> objects <em>within</em> <code class="docutils literal notranslate"><span class="pre">processCoordinates</span></code>. Otherwise, there would be multiple workers acting on the same object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">distances</span>

<span class="k">def</span> <span class="nf">processCoordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coords</span><span class="p">):</span>

    <span class="n">u_ref</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">ref_file</span><span class="p">)</span>
    <span class="n">u_check</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">ref_file</span><span class="p">)</span>

    <span class="n">dist_out</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">u_check</span><span class="o">.</span><span class="n">load_new</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">u_check</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>

        <span class="n">dists</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span>
            <span class="n">u_check</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">),</span>
            <span class="n">u_ref</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>
        <span class="p">)[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">dist_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>

    <span class="n">dist_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist_out</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist_out</span>

<span class="n">modelWE</span><span class="o">.</span><span class="n">processCoordinates</span> <span class="o">=</span> <span class="n">processCoordinates</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Model-building-with-build_analyze_model()">
<h2>Model-building with <a class="reference internal" href="../api.html#msm_we.modelWE.build_analyze_model"><span class="std std-ref">build_analyze_model()</span></a><a class="headerlink" href="#Model-building-with-build_analyze_model()" title="Permalink to this heading"></a></h2>
<p>You can construct an haMSM (and validation haMSMs) with one call to <a class="reference internal" href="../api.html#msm_we.modelWE.build_analyze_model" title="msm_we.modelWE.build_analyze_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_analyze_model()</span></code></a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">modelWE</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">build_analyze_model</span><span class="p">(</span>
    <span class="n">file_paths</span><span class="o">=</span><span class="n">h5file_paths</span><span class="p">,</span>
    <span class="c1"># ref_struct=basis_ref_dict,</span>
    <span class="n">ref_struct</span><span class="o">=</span><span class="n">ref_file</span><span class="p">,</span>
    <span class="n">modelName</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
    <span class="n">basis_pcoord_bounds</span><span class="o">=</span><span class="n">pcoord_bounds</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">],</span>
    <span class="n">target_pcoord_bounds</span><span class="o">=</span><span class="n">pcoord_bounds</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span>
    <span class="n">dimreduce_method</span><span class="o">=</span><span class="n">dimreduce_method</span><span class="p">,</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="n">clusters_per_stratum</span><span class="p">,</span>
    <span class="n">tau</span><span class="o">=</span><span class="n">tau</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c745fe04bb94d79bae1e3348bb1df38", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">2022-10-10 10:41:57,299 INFO worker.py:1509 -- Started a local
Ray instance. View the dashboard at <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">127.0.0.1:8265 </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f68a887648ef496ebdcb39dc07f1e60a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "794443f955ac4983a26965f8fccf3b32", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e3f58230093e4749bf76c4cbe395a518", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Be aware: Number of cluster centers   <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#141" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">141</span></a>
         is an important parameter, and can    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         drastically affect model quality. We  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         recommend examining block-validation  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         results with a range of numbers of    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         clusters, to check for overfitting.   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Beginning stratified clustering.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#148" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">148</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Obtaining bin definitions from        <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#568" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">568</span></a>
         iteration <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> in file                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         ..<span style="color: #800080; text-decoration-color: #800080">/tests/reference/1000ns_ntl9/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">west.h</span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         <span style="color: #ff00ff; text-decoration-color: #ff00ff">5</span>                                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Loading pickled bin mapper from H5    <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#572" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">572</span></a>
         for stratified clustering<span style="color: #808000; text-decoration-color: #808000">...</span>          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Doing stratified clustering  <a href="file:///home/jd/msm_we/msm_we/stratified_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">stratified_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/stratified_clustering.py#66" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">66</span></a>
         with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> total clusters      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                           </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "611f44c1201b42938be7be2c88df662a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "57bff53cba1749d5b8dad219dd76f615", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aa1479ba8a6c4c778b441014ab7bc1ae", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185903)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185910)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185906)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185908)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185913)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185916)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185904)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185915)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185911)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185914)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185912)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185909)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185907)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185902)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185905)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">(do_stratified_ray_discretization pid=185917)</span> Warning: importing
'simtk.openmm' is deprecated.  Import 'openmm' instead.
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c00f8661da1c43f1a2abd139bdea955f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0dbd967b5c9c4abc89ecd90cf09af33a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Started with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> clusters, and       <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1020" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1020</span></a>
         removed <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">108</span>                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000">WARNING </span> All clusters were cleaned from bins  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1036" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1036</span></a>
         <span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span><span style="font-weight: bold">}</span>                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using cached model for               <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1132" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1132</span></a>
         discretization                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "09fabb296fe34d91afd0563a1288da75", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "58a628abef6b46bb9daaa09f168b767f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">/home/jd/msm_we/msm_we/_hamsm/_clustering.py:1532:
VisibleDeprecationWarning: Creating an ndarray from ragged nested
sequences (which is a list-or-tuple of lists-or-tuples-or
ndarrays with different lengths or shapes) is deprecated. If you
meant to do this, you must specify 'dtype=object' when creating
the ndarray.
  self.targetRMSD_all =
np.array(cluster_pcoord_all)[pcoord_sort_indices]
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e94d210f52b34208be117978400a8bb0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9354d9de254b450aa63d6982f40c7f6e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span>                                         <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#170" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">170</span></a>
         Flux converged to <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.8830e+06</span> after <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
         iterations of inverse iteration.        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Done with steady-state estimation.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#181" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">181</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Beginning analysis of cross-validation     <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#926" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">926</span></a>
         group <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>/<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>.                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bb9bdf36ff7447678a32f60ebfe4011a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d4b21641d546464caa7569fbca221131", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Started with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> clusters, and       <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1020" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1020</span></a>
         removed <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">128</span>                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000">WARNING </span> All clusters were cleaned from bins  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1036" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1036</span></a>
         <span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span><span style="font-weight: bold">}</span>                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using cached model for               <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1132" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1132</span></a>
         discretization                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0a24883faf3e4982bc9b6723ca09cb1c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "64c983097e0841908dc6b3bc96e747fd", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "eb3da5ae8edb4b68a345efe8d7f63fad", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b75b9140b5e14c91a4f559deb6a782b6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span>                                         <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#170" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">170</span></a>
         Flux converged to <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.5930e+05</span> after <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
         iterations of inverse iteration.        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Done with steady-state estimation.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#181" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">181</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Beginning analysis of cross-validation     <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#926" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">926</span></a>
         group <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>/<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>.                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "df4f77675c4f4c8a96f5ddb58d3acf0b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4bc072d63f654dd59c7ad9a12c0ee6b2", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Started with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> clusters, and       <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1020" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1020</span></a>
         removed <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">123</span>                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000">WARNING </span> All clusters were cleaned from bins  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1036" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1036</span></a>
         <span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span><span style="font-weight: bold">}</span>                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using cached model for               <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1132" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1132</span></a>
         discretization                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "faff2a9f431242f39b11faf8524f08fb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "467136d6b7994198960223b3358b1dcd", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d76a7f7c0be74a78a4676a6aaab946fd", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a03597d728284ab2a75c87de67c14840", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span>                                         <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#170" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">170</span></a>
         Flux converged to <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.8846e+06</span> after <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
         iterations of inverse iteration.        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Done with steady-state estimation.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#181" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">181</span></a>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre></div>
</div>
</section>
<section id="Model-building-step-by-step">
<h2>Model-building step by step<a class="headerlink" href="#Model-building-step-by-step" title="Permalink to this heading"></a></h2>
<p><a class="reference internal" href="../api.html#msm_we.modelWE.build_analyze_model"><span class="std std-ref">build_analyze_model()</span></a> is just a convenient wrapper around the following steps.</p>
<p>You can run them manually if you want to observe each step of the process.</p>
<p>It’s helpful to start off by running step-by-step while you’re starting analysis for a system, to fine-tune parameters without re-running the entire workflow.</p>
<p>First, we launch Ray, which is the backend for the parallel work manager.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">ignore_reinit_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">2022-10-10 10:42:47,151 INFO worker.py:1351 -- Calling ray.init()
again after it has already been called.
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
    <div style="margin-left: 50px;display: flex;flex-direction: row;align-items: center">
        <h3 style="color: var(--jp-ui-font-color0)">Ray</h3>
        <svg version="1.1" id="ray" width="3em" viewBox="0 0 144.5 144.6" style="margin-left: 3em;margin-right: 3em">
            <g id="layer-1">
                <path fill="#00a2e9" class="st0" d="M97.3,77.2c-3.8-1.1-6.2,0.9-8.3,5.1c-3.5,6.8-9.9,9.9-17.4,9.6S58,88.1,54.8,81.2c-1.4-3-3-4-6.3-4.1
                    c-5.6-0.1-9.9,0.1-13.1,6.4c-3.8,7.6-13.6,10.2-21.8,7.6C5.2,88.4-0.4,80.5,0,71.7c0.1-8.4,5.7-15.8,13.8-18.2
                    c8.4-2.6,17.5,0.7,22.3,8c1.3,1.9,1.3,5.2,3.6,5.6c3.9,0.6,8,0.2,12,0.2c1.8,0,1.9-1.6,2.4-2.8c3.5-7.8,9.7-11.8,18-11.9
                    c8.2-0.1,14.4,3.9,17.8,11.4c1.3,2.8,2.9,3.6,5.7,3.3c1-0.1,2,0.1,3,0c2.8-0.5,6.4,1.7,8.1-2.7s-2.3-5.5-4.1-7.5
                    c-5.1-5.7-10.9-10.8-16.1-16.3C84,38,81.9,37.1,78,38.3C66.7,42,56.2,35.7,53,24.1C50.3,14,57.3,2.8,67.7,0.5
                    C78.4-2,89,4.7,91.5,15.3c0.1,0.3,0.1,0.5,0.2,0.8c0.7,3.4,0.7,6.9-0.8,9.8c-1.7,3.2-0.8,5,1.5,7.2c6.7,6.5,13.3,13,19.8,19.7
                    c1.8,1.8,3,2.1,5.5,1.2c9.1-3.4,17.9-0.6,23.4,7c4.8,6.9,4.6,16.1-0.4,22.9c-5.4,7.2-14.2,9.9-23.1,6.5c-2.3-0.9-3.5-0.6-5.1,1.1
                    c-6.7,6.9-13.6,13.7-20.5,20.4c-1.8,1.8-2.5,3.2-1.4,5.9c3.5,8.7,0.3,18.6-7.7,23.6c-7.9,5-18.2,3.8-24.8-2.9
                    c-6.4-6.4-7.4-16.2-2.5-24.3c4.9-7.8,14.5-11,23.1-7.8c3,1.1,4.7,0.5,6.9-1.7C91.7,98.4,98,92.3,104.2,86c1.6-1.6,4.1-2.7,2.6-6.2
                    c-1.4-3.3-3.8-2.5-6.2-2.6C99.8,77.2,98.9,77.2,97.3,77.2z M72.1,29.7c5.5,0.1,9.9-4.3,10-9.8c0-0.1,0-0.2,0-0.3
                    C81.8,14,77,9.8,71.5,10.2c-5,0.3-9,4.2-9.3,9.2c-0.2,5.5,4,10.1,9.5,10.3C71.8,29.7,72,29.7,72.1,29.7z M72.3,62.3
                    c-5.4-0.1-9.9,4.2-10.1,9.7c0,0.2,0,0.3,0,0.5c0.2,5.4,4.5,9.7,9.9,10c5.1,0.1,9.9-4.7,10.1-9.8c0.2-5.5-4-10-9.5-10.3
                    C72.6,62.3,72.4,62.3,72.3,62.3z M115,72.5c0.1,5.4,4.5,9.7,9.8,9.9c5.6-0.2,10-4.8,10-10.4c-0.2-5.4-4.6-9.7-10-9.7
                    c-5.3-0.1-9.8,4.2-9.9,9.5C115,72.1,115,72.3,115,72.5z M19.5,62.3c-5.4,0.1-9.8,4.4-10,9.8c-0.1,5.1,5.2,10.4,10.2,10.3
                    c5.6-0.2,10-4.9,9.8-10.5c-0.1-5.4-4.5-9.7-9.9-9.6C19.6,62.3,19.5,62.3,19.5,62.3z M71.8,134.6c5.9,0.2,10.3-3.9,10.4-9.6
                    c0.5-5.5-3.6-10.4-9.1-10.8c-5.5-0.5-10.4,3.6-10.8,9.1c0,0.5,0,0.9,0,1.4c-0.2,5.3,4,9.8,9.3,10
                    C71.6,134.6,71.7,134.6,71.8,134.6z"/>
            </g>
        </svg>
        <table>
            <tr>
                <td style="text-align: left"><b>Python version:</b></td>
                <td style="text-align: left"><b>3.9.13</b></td>
            </tr>
            <tr>
                <td style="text-align: left"><b>Ray version:</b></td>
                <td style="text-align: left"><b> 2.0.0</b></td>
            </tr>
            <tr>
    <td style="text-align: left"><b>Dashboard:</b></td>
    <td style="text-align: left"><b><a href="http://127.0.0.1:8265" target="_blank">http://127.0.0.1:8265</a></b></td>
</tr>

        </table>
    </div>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">modelWE</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span>
    <span class="n">fileSpecifier</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;../tests/reference/1000ns_ntl9/west.h5&#39;</span><span class="p">],</span>
    <span class="n">refPDBfile</span><span class="o">=</span><span class="n">ref_file</span><span class="p">,</span>
    <span class="n">modelName</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
    <span class="n">basis_pcoord_bounds</span><span class="o">=</span><span class="n">pcoord_bounds</span><span class="p">[</span><span class="s1">&#39;basis&#39;</span><span class="p">],</span>
    <span class="n">target_pcoord_bounds</span><span class="o">=</span><span class="n">pcoord_bounds</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span>
    <span class="n">dim_reduce_method</span><span class="o">=</span><span class="n">dimreduce_method</span><span class="p">,</span>
    <span class="n">tau</span><span class="o">=</span><span class="n">tau</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_iterations</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">get_coordSet</span><span class="p">(</span><span class="n">last_iter</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">maxIter</span><span class="p">,</span> <span class="n">streaming</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a39a9476de08470d8a130bc0ae053c16", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">dimReduce</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e40c84edc89d4796b585419e955e52a8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "409e8ce837774a55bc1c05767bf260c7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">store_validation_model=True</span></code> is necessary for block validation. It enables caching the model immediately after discretization in <code class="docutils literal notranslate"><span class="pre">model.post_cluster_model</span></code>, so that the blocks can be efficiently created later.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">cluster_coordinates</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="n">clusters_per_stratum</span><span class="p">,</span>
    <span class="n">use_ray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">store_validation_model</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Required for block validation</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">1337</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Be aware: Number of cluster centers   <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#141" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">141</span></a>
         is an important parameter, and can    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         drastically affect model quality. We  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         recommend examining block-validation  <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         results with a range of numbers of    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         clusters, to check for overfitting.   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Beginning stratified clustering.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#148" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">148</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Obtaining bin definitions from        <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#568" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">568</span></a>
         iteration <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span> in file                   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         ..<span style="color: #800080; text-decoration-color: #800080">/tests/reference/1000ns_ntl9/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">west.h</span> <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         <span style="color: #ff00ff; text-decoration-color: #ff00ff">5</span>                                     <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Loading pickled bin mapper from H5    <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#572" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">572</span></a>
         for stratified clustering<span style="color: #808000; text-decoration-color: #808000">...</span>          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000; font-weight: bold">ERROR   </span> Stratified clustering currently MUST  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#608" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">608</span></a>
         run in streaming mode <span style="font-weight: bold">(</span>and with ray   <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         enabled for discretization<span style="font-weight: bold">)</span>. Enabling <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
         both and continuing<span style="color: #808000; text-decoration-color: #808000">...</span>                <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                  </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Doing stratified clustering  <a href="file:///home/jd/msm_we/msm_we/stratified_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">stratified_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/stratified_clustering.py#66" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">66</span></a>
         with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> total clusters      <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                           </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5be8919e2e964b6f8613dd111ff4c073", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
Warning: importing &#39;simtk.openmm&#39; is deprecated.  Import &#39;openmm&#39; instead.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c26397a6fe5f4a348919798acda38b7b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2076315af30541978dfccc1f649a6b24", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_fluxMatrix</span><span class="p">(</span><span class="n">n_lag</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e19da65f89b74b44a31ee8dd66632747", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>It’s likely our flux matrix isn’t strongly connected. This cleaning step removes all clusters that aren’t in the largest connected set, then rediscretizes all the trajectories according to the new, reduced set of clusters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">organize_fluxMatrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Started with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> clusters, and       <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1020" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1020</span></a>
         removed <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">109</span>                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000">WARNING </span> All clusters were cleaned from bins  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1036" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1036</span></a>
         <span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span><span style="font-weight: bold">}</span>                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using cached model for               <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1132" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1132</span></a>
         discretization                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dbd24ad93af049558f9476c2e1dd7ba7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5c53b036b36c4ddf98c8038a304c70af", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "005f05f873d947eb92e33a4dd7b29911", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">generate_test_files</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../tests/reference/1000ns_ntl9/models/organized.obj&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;../tests/reference/1000ns_ntl9/models/fluxmatrix.npy&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">fluxMatrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Transition-matrix-estimation">
<h3>Transition matrix estimation<a class="headerlink" href="#Transition-matrix-estimation" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_Tmatrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">Tmatrix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.32293215, 0.30579927, 0.01005867, ..., 0.        , 0.33022179,
        0.        ],
       [0.27769355, 0.31023711, 0.0148812 , ..., 0.        , 0.2590533 ,
        0.        ],
       [0.28155956, 0.24801922, 0.00295366, ..., 0.        , 0.26514922,
        0.        ],
       ...,
       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
        0.32410505],
       [0.31693347, 0.27896914, 0.0031783 , ..., 0.        , 0.35730547,
        0.        ],
       [0.        , 0.        , 0.        , ..., 0.        , 1.        ,
        0.        ]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_steady_state</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span>                                         <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#170" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">170</span></a>
         Flux converged to <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2.0346e+06</span> after <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
         iterations of inverse iteration.        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Done with steady-state estimation.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#181" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">181</span></a>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">get_steady_state_target_flux</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Model-validation">
<h3>Model validation<a class="headerlink" href="#Model-validation" title="Permalink to this heading"></a></h3>
<p>This block validation step</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">do_block_validation</span><span class="p">(</span>
    <span class="n">cross_validation_groups</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">cross_validation_blocks</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Beginning analysis of cross-validation     <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#926" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">926</span></a>
         group <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>/<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>.                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2a11cf0c2c5249c3b8d1cb80c5d8eaa3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ca3084207ead435685ae699e803f6449", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Started with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> clusters, and       <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1020" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1020</span></a>
         removed <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">127</span>                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000">WARNING </span> All clusters were cleaned from bins  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1036" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1036</span></a>
         <span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span><span style="font-weight: bold">}</span>                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using cached model for               <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1132" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1132</span></a>
         discretization                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a84f46b537514476a3d54222d1b42b05", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9d140b9631ac42feb04f1933cd422ccb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "89d582d0827e483a8998f5db28e2f8e6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e854edeb6bae46d4922f874ca954949f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span>                                         <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#170" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">170</span></a>
         Flux converged to <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.6309e+06</span> after <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
         iterations of inverse iteration.        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Done with steady-state estimation.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#181" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">181</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Beginning analysis of cross-validation     <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#926" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">926</span></a>
         group <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>/<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>.                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">             </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1f796f24966747d49d18e09f57600b22", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9a7b6cb26ce64214bb52699a9b07976f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Started with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">300</span> clusters, and       <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1020" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1020</span></a>
         removed <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">119</span>                          <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #800000; text-decoration-color: #800000">WARNING </span> All clusters were cleaned from bins  <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1036" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1036</span></a>
         <span style="font-weight: bold">{</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">11</span><span style="font-weight: bold">}</span>                                 <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using cached model for               <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1132" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1132</span></a>
         discretization                       <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                   </span>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3cfaae4a3bb944649c7c8cbe900db6b0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f6fa660daf9542c99cc8e4e9a711a862", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Discretization complete              <a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_clustering.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_clustering.py#1204" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">1204</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Using Ray cluster with <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">16.0</span> CPUs!          <a href="file:///home/jd/msm_we/msm_we/msm_we.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">msm_we.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/msm_we.py#450" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">450</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1b66319915e44502a31455966f9ab6e6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "18bfc4ad15244dfda81d6a27ef864af9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Fluxmatrices all obtained             <a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_fluxmatrix.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_fluxmatrix.py#497" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">497</span></a>
</pre></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span>                                         <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#170" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">170</span></a>
         Flux converged to <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4.4589e+06</span> after <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>    <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
         iterations of inverse iteration.        <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #000080; text-decoration-color: #000080">INFO    </span> Done with steady-state estimation.      <a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_analysis.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///home/jd/msm_we/msm_we/_hamsm/_analysis.py#181" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">181</span></a>
</pre></div>
</div>
</section>
<section id="Generate-lists-of-structures-in-each-cluster">
<h3>Generate lists of structures in each cluster<a class="headerlink" href="#Generate-lists-of-structures-in-each-cluster" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">update_cluster_structures</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Save-model">
<h2>Save model<a class="headerlink" href="#Save-model" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/pickled_model&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">of</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">of</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="analysis.html" class="btn btn-neutral float-right" title="Trp-cage haMSM Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, John Russo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>