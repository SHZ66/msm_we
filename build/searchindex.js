Search.setIndex({"docnames": ["_examples/analysis", "_examples/hamsm_construction", "_examples/optimization", "api", "authors", "code_todos", "examples", "examples.hamsm", "examples.optimization", "history", "index", "readme", "usage"], "filenames": ["_examples/analysis.ipynb", "_examples/hamsm_construction.ipynb", "_examples/optimization.ipynb", "api.rst", "authors.rst", "code_todos.rst", "examples.rst", "examples.hamsm.rst", "examples.optimization.rst", "history.rst", "index.rst", "readme.rst", "usage.rst"], "titles": ["Trp-cage haMSM Analysis", "Trp-cage haMSM Construction and Analysis", "Trp-cage WE Optimization", "Documentation", "Credits", "TODOs", "Examples", "haMSM Construction Examples", "Optimization Examples", "History", "Welcome to msm_we\u2019s documentation!", "msm_we", "Installation/Usage"], "terms": {"1": [0, 1, 2, 3, 12], "import": [0, 1, 2, 3, 12], "matplotlib": 0, "pyplot": 0, "plt": 0, "we": [0, 1, 3, 6, 12], "ll": [0, 1, 12], "us": [0, 1, 2, 3, 12], "creat": [0, 1, 3, 11, 12], "construct": [0, 12], "exampl": [0, 1, 3, 10, 12], "2": [0, 1, 2, 3, 12], "pickl": [0, 1, 2], "open": [0, 1, 2, 3], "data": [0, 1, 2, 3, 10, 11, 12], "pickled_model": [0, 1, 2], "rb": [0, 2], "inf": [0, 2, 3], "model": [0, 2, 11], "3": [0, 1, 2, 3, 11], "cluster_cent": 0, "targetrmsd_cent": 0, "scatter": 0, "pss": [0, 2, 3], "color": [0, 3], "k": [0, 3], "These": 0, "have": [0, 3, 12], "nan": 0, "entri": [0, 2, 3, 5, 12], "so": [0, 3, 12], "set": [0, 1, 2, 3, 12], "them": [0, 1], "manual": [0, 1, 12], "bound": [0, 3, 12], "target_pcoord": 0, "target_pcoord_bound": [0, 1, 2, 3, 12], "0": [0, 1, 2, 3, 12], "basis_pcoord": 0, "basis_pcoord_bound": [0, 1, 2, 3, 12], "indtarget": [0, 2], "r": [0, 3], "indbasi": 0, "b": [0, 2, 3, 12], "yscale": 0, "log": [0, 1, 3], "ylabel": 0, "probabl": [0, 3, 5], "xlabel": 0, "msm": [0, 1, 3, 10, 12], "averag": [0, 3], "progress": [0, 1, 3, 12], "coordin": [0, 1, 3, 5, 12], "text": [0, 3], "5": [0, 1, 2, 3, 5], "39": [0, 1], "can": [0, 1, 3, 10, 12], "comput": [0, 3, 11, 12], "each": [0, 1, 3, 12], "microst": [0, 1, 3], "which": [0, 1, 2, 3, 11, 12], "i": [0, 1, 2, 3, 5, 10, 11, 12], "trajectori": [0, 3, 10, 11], "initi": [0, 1, 2, 3, 5, 9, 12], "from": [0, 1, 2, 3, 10, 11, 12], "reach": [0, 3], "target": [0, 1, 2, 3, 12], "befor": [0, 3, 12], "basi": [0, 1, 2, 3, 12], "4": [0, 1, 2, 3], "get_committor": [0, 3], "10": [0, 1, 2, 3], "03": [0, 1, 2], "22": [0, 2], "17": [0, 1, 2], "34": 0, "40": 0, "warn": [0, 1, 12], "note": [0, 3, 12], "weight": [0, 1, 3, 10, 11, 12], "ensembl": [0, 10, 11, 12], "being": [0, 3, 12], "analyz": [0, 3], "msm_we": [0, 1, 2, 5, 12], "py": [0, 1, 2, 5, 12], "7073": 0, "thi": [0, 1, 2, 3, 5, 10, 11, 12], "pseudocommittor": 0, "true": [0, 1, 3, 12], "result": [0, 1, 3, 12], "one": [0, 1, 3], "wai": [0, 3, 12], "It": [0, 1, 3, 12], "": [0, 1, 2, 3, 12], "often": 0, "interest": 0, "look": [0, 12], "relationship": 0, "between": [0, 3, 12], "our": [0, 1], "here": [0, 3, 5, 12], "see": [0, 12], "degener": 0, "suggest": 0, "great": 0, "q": [0, 3], "axvlin": 0, "6": [0, 1, 2], "get_flux": [0, 3], "plot": 0, "full": [0, 1, 3, 5, 12], "well": 0, "valid": [0, 1, 3, 12], "The": [0, 2, 3, 5, 12], "flat": 0, "proxi": 0, "how": 0, "converg": [0, 1, 3, 12], "your": [0, 3, 12], "visual": 0, "space": [0, 1, 2, 3, 12], "7": [0, 1, 2, 11], "ax": [0, 3], "plot_flux": [0, 3], "set_xlim": 0, "8": [0, 2, 11], "set_ylim": 0, "5e3": 0, "5e7": 0, "yet": [0, 4], "been": [0, 1, 3, 12], "gener": [0, 3], "validation_model_0": 0, "6288": 0, "now": 0, "validation_model_1": 0, "5000": 0, "50000000": 0, "Or": 0, "plot_flux_committor": [0, 3], "main_model": 0, "6138": 0, "6132": 0, "41": 0, "9": [0, 1, 2], "update_cluster_structur": [0, 12], "let": [0, 1], "get": [0, 3], "got": 0, "assign": [0, 10, 12], "cluster_structur": 0, "shape": [0, 1, 3], "272": 0, "For": [1, 3], "an": [1, 2, 3, 12], "simul": [1, 3, 10, 12], "unfold": 1, "numpi": [1, 2, 3], "np": [1, 2, 12], "rai": [1, 3, 12], "just": [1, 3, 5, 12], "clean": [1, 3, 12], "up": [1, 3, 12], "output": [1, 3, 12], "displai": 1, "document": [1, 11, 12], "webpag": 1, "handler": 1, "_log_rend": 1, "show_tim": 1, "fals": [1, 3, 12], "consol": 1, "width": 1, "65": 1, "first": [1, 3, 4, 12], "some": [1, 3, 12], "paramet": [1, 3], "h5file_path": 1, "west": [1, 3, 12], "h5": [1, 3, 12], "number": [1, 3, 12], "put": 1, "stratum": 1, "bin": [1, 3, 12], "clusters_per_stratum": 1, "35": 1, "dimreduce_method": [1, 3, 12], "vamp": [1, 3, 11, 12], "boundari": [1, 2, 3, 10, 12], "pcoord_bound": [1, 12], "100": [1, 3], "model_nam": [1, 12], "nacl": 1, "sampl": [1, 3, 12], "refer": [1, 3], "structur": [1, 3, 12], "ref_fil": 1, "2jof": 1, "pdb": [1, 3], "westpa": [1, 2, 11, 12], "resampl": [1, 3, 12], "time": [1, 3, 12], "tau": [1, 3, 12], "1e": [1, 3], "xyz": 1, "featur": [1, 12], "simpl": 1, "poor": 1, "choic": 1, "pairwis": 1, "alpha": 1, "carbon": 1, "would": 1, "better": [1, 3], "m": [1, 3], "simplic": 1, "def": [1, 12], "processcoordin": [1, 12], "self": [1, 3, 12], "coord": [1, 3, 12], "return": [1, 3, 12], "reshap": 1, "modelw": [1, 5, 12], "you": [1, 3, 12], "call": [1, 11, 12], "file_path": [1, 3, 12], "ref_struct": [1, 3, 12], "basis_ref_dict": [1, 12], "modelnam": [1, 3, 12], "n_cluster": [1, 3, 12], "2022": [1, 3], "30": 1, "44": 1, "884": 1, "info": [1, 2], "worker": [1, 12], "1509": 1, "start": [1, 3], "local": 1, "instanc": [1, 3, 12], "view": 1, "dashboard": 1, "127": 1, "8265": 1, "perform": [1, 3, 12], "2769": 1, "reduc": [1, 3], "816": 1, "496": 1, "2782": 1, "compon": 1, "Be": 1, "awar": 1, "cluster": [1, 2, 3, 12], "center": [1, 12], "3057": 1, "drastic": 1, "affect": [1, 3], "qualiti": 1, "recommend": [1, 12], "examin": 1, "block": [1, 3, 12], "rang": [1, 3], "check": [1, 3], "overfit": 1, "begin": 1, "stratifi": [1, 2, 3, 12], "3064": 1, "obtain": [1, 3, 12], "definit": [1, 3], "iter": [1, 3, 12], "3482": 1, "file": [1, 3, 12], "load": [1, 3, 5, 12], "mapper": [1, 2, 12], "3486": 1, "do": [1, 3, 10, 11, 12], "420": 1, "total": [1, 2, 3, 12], "254": 1, "couldn": 1, "t": [1, 3, 12], "last": [1, 2, 3, 12], "3595": 1, "all": [1, 3, 12], "fill": 1, "16": 1, "cpu": 1, "873": 1, "discret": [1, 3, 12], "complet": [1, 12], "4177": 1, "fluxmatric": 1, "4926": 1, "remov": [1, 3, 5], "4001": 1, "350": 1, "were": 1, "11": 1, "4017": 1, "cach": 1, "4113": 1, "home": [1, 5], "jd": 1, "4248": 1, "visibledeprecationwarn": 1, "ndarrai": [1, 3], "rag": 1, "nest": 1, "sequenc": [1, 3], "list": [1, 2, 3, 12], "tupl": [1, 3], "differ": [1, 3], "length": [1, 3, 12], "deprec": 1, "If": [1, 2, 3, 12], "meant": 1, "must": [1, 3, 12], "specifi": [1, 3, 12], "dtype": [1, 3], "object": [1, 2, 3, 12], "when": [1, 3, 12], "targetrmsd_al": 1, "arrai": [1, 2, 3, 12], "cluster_pcoord_al": 1, "pcoord_sort_indic": 1, "5571": 1, "flux": [1, 3, 11, 12], "2810e": 1, "06": 1, "after": 1, "invers": [1, 3], "done": [1, 3, 12], "steadi": [1, 3, 11, 12], "state": [1, 2, 3, 11, 12], "estim": [1, 3, 11, 12], "5582": 1, "cross": [1, 3], "1322": 1, "group": [1, 3, 12], "370": 1, "0158e": 1, "372": 1, "0039e": 1, "conveni": [1, 3], "wrapper": 1, "around": 1, "follow": [1, 11, 12], "run": [1, 2, 3, 12], "want": [1, 3, 5, 11, 12], "observ": [1, 3], "process": [1, 3, 12], "help": 1, "off": 1, "while": 1, "re": 1, "system": [1, 12], "fine": [1, 3, 12], "tune": 1, "without": 1, "entir": 1, "workflow": [1, 3, 12], "init": [1, 3, 12], "ignore_reinit_error": 1, "31": 1, "04": 1, "428": 1, "1351": 1, "again": 1, "ha": [1, 2, 3, 12], "alreadi": 1, "python": [1, 3, 11], "version": 1, "13": 1, "http": [1, 3, 11], "filespecifi": [1, 3], "refpdbfil": [1, 3], "dim_reduce_method": [1, 3, 12], "get_iter": [1, 12], "get_coordset": [1, 3, 5, 12], "last_it": [1, 3, 12], "maxit": [1, 3], "stream": [1, 3], "dimreduc": [1, 3, 11, 12], "cluster_coordin": [1, 3, 12], "use_rai": [1, 3, 12], "store_validation_model": [1, 3], "requir": 1, "error": [1, 3], "current": [1, 12], "3522": 1, "mode": 1, "enabl": [1, 3, 12], "both": [1, 3], "continu": [1, 3], "14": 1, "get_fluxmatrix": [1, 3, 12], "n_lag": [1, 3], "15": 1, "organize_fluxmatrix": [1, 3, 5, 12], "get_tmatrix": [1, 3, 12], "get_steady_st": [1, 3, 12], "18": 1, "get_steady_state_target_flux": [1, 3, 12], "19": 1, "do_block_valid": 1, "cross_validation_group": [1, 3], "cross_validation_block": [1, 3], "20": 1, "wb": 1, "dump": 1, "mo": [2, 12], "steady_state_distribut": [2, 12], "n_active_we_bin": [2, 12], "solve_discrep": [2, 3, 12], "tmatrix": [2, 3, 12], "pi": [2, 3, 12], "36": 2, "38": 2, "matrix": [2, 3, 12], "49": 2, "element": [2, 3, 12], "microbin": [2, 12], "integ": [2, 3, 12], "index": [2, 3, 10, 12], "In": [2, 3, 12], "other": [2, 11, 12], "word": [2, 12], "microstate_assign": [2, 12], "microbin_index": [2, 12], "get_uniform_mfpt_bin": [2, 3, 12], "add": [2, 3, 11, 12], "sinc": [2, 3, 12], "those": [2, 3, 12], "two": [2, 3, 12], "concaten": [2, 12], "base_mapp": [2, 12], "bin_mapp": 2, "n_pcoord_dim": [2, 12], "new": [2, 3, 12], "we_bin_mapp": [2, 12], "case": [2, 3, 11, 12], "pcoord": [2, 3, 12], "extend": [2, 12], "origin": [2, 3, 5, 12], "dimension": [2, 3, 12], "wa": [2, 3, 11, 12], "ar": [2, 3, 10, 12], "non": [2, 3, 12], "binmapp": [2, 12], "multipl": [2, 3], "argument": [2, 3, 12], "provid": [2, 3, 11, 12], "167": 2, "72": 2, "includ": 2, "227": 2, "lt": 2, "0x7fdea5f2a6a0": 2, "gt": 2, "microstate_mapp": [2, 3], "class": [3, 12], "sourc": 3, "histori": [3, 10, 11], "augment": [3, 10, 11, 12], "markov": [3, 11], "implement": [3, 12], "particularli": 3, "recycl": [3, 10], "sink": 3, "typic": 3, "store": 3, "auxdata": [3, 12], "copperman": [3, 4, 11], "zuckerman": 3, "acceler": 3, "long": 3, "timescal": 3, "kinet": 3, "combin": 3, "microstateg": 3, "markovian": 3, "theori": 3, "arxiv": 3, "2020": 3, "build_analyze_model": [3, 12], "ray_kwarg": 3, "max_coord_it": 3, "fluxmatrix_it": 3, "fluxmatrix_iters_to_us": 3, "none": [3, 4, 12], "show_live_displai": 3, "step_kwarg": 3, "One": 3, "shot": 3, "function": [3, 12], "onc": 3, "interfac": 3, "blockwis": 3, "mai": [3, 11, 12], "desir": [3, 12], "veri": [3, 11], "still": 3, "debug": [3, 11], "where": [3, 12], "might": 3, "make": 3, "sens": 3, "individu": 3, "step": [3, 12], "path": [3, 12], "string": 3, "defin": [3, 12], "topologi": [3, 12], "name": [3, 12], "filenam": 3, "pcoord0": [3, 12], "lower": [3, 12], "pcoord1": [3, 12], "upper": [3, 12], "str": 3, "reduct": [3, 12], "method": [3, 12], "pca": [3, 11, 12], "float": 3, "e": [3, 12], "map": 3, "physic": [3, 12], "int": 3, "per": [3, 12], "aggreg": [3, 12], "dict": 3, "keyword": [3, 12], "pass": [3, 12], "num_cpu": 3, "could": 3, "also": [3, 12], "connect": [3, 12], "exist": [3, 9, 12], "option": [3, 11], "default": 3, "exclud": [3, 12], "end": 3, "bool": 3, "independ": [3, 12], "within": [3, 12], "over": [3, 12], "input": 3, "rather": [3, 12], "than": [3, 11, 12], "batch": 3, "substanti": 3, "improv": 3, "memori": [3, 5, 12], "effici": 3, "potenti": 3, "small": [3, 12], "hit": [3, 12], "parallel": 3, "speedup": 3, "fluxmatrix": 3, "specif": 3, "oppos": 3, "like": [3, 12], "either": [3, 12], "OR": 3, "contain": [3, 12], "split": [3, 12], "pcoord_ndim": [3, 12], "auxpath": 3, "_suppress_boundary_warn": 3, "use_weights_in_clust": 3, "builder": 3, "under": 3, "type": 3, "should": [3, 5, 12], "merg": [3, 5], "constructor": [3, 5], "later": 3, "usag": [3, 5, 10], "onli": [3, 12], "avoid": [3, 5, 12], "much": [3, 5], "possibl": [3, 5], "That": [3, 5], "mean": [3, 5, 10], "try": [3, 5], "replac": [3, 5, 12], "all_coord": [3, 5], "first_it": [3, 12], "first_rough_it": 3, "rough_strid": 3, "fine_strid": 3, "variance_cutoff": 3, "95": 3, "use_weight": 3, "scheme": 3, "doe": 3, "NOT": [3, 12], "actual": 3, "transform": [3, 12], "via": 3, "reducecoordin": 3, "updat": [3, 12], "ndim": 3, "first_cluster_it": [3, 12], "iters_to_us": 3, "_cluster_arg": [3, 12], "result_batch_s": 3, "given": 3, "lag": [3, 12], "written": 3, "_": 3, "_e": 3, "_lag": 3, "_clust": 3, "recalcul": 3, "earlier": 3, "otherwis": [3, 12], "write": [3, 12], "errorweight": 3, "errorcount": 3, "fluxmatrixraw": 3, "arg": 3, "transit": [3, 12], "correct": 3, "more": 3, "row": 3, "normal": [3, 12], "ani": [3, 12], "ot": 3, "uniformli": 3, "flux_fractional_converg": 3, "0001": 3, "max_it": [3, 12], "distribut": [3, 11, 12], "scipi": 3, "eigensolv": 3, "guess": 3, "refin": 3, "matric": 3, "span": 3, "mani": [3, 12], "order": 3, "magnitud": 3, "extrem": 3, "high": 3, "condit": [3, 10], "furthermor": 3, "smallest": 3, "most": [3, 12], "valu": 3, "machin": [3, 12], "precis": 3, "truncat": 3, "point": 3, "produc": [3, 10, 12], "bad": 3, "neg": 3, "inaccur": 3, "spars": 3, "oper": 3, "A": [3, 12], "stationari": 3, "further": 3, "determin": 3, "chang": 3, "_set": 3, "lagtim": 3, "jtargetss": 3, "noth": 3, "boolean": 3, "conv": 3, "05": 3, "committor": [3, 11], "take": [3, 12], "appli": 3, "side": 3, "absorb": 3, "out": 3, "multipli": 3, "until": 3, "below": [3, 11], "numer": 3, "criteria": 3, "stop": 3, "q_p": 3, "less": 3, "measur": 3, "get_model_clust": 3, "get_iter_aristoffian": 3, "untest": 3, "un": 3, "own": 3, "risk": 3, "model_clust": 3, "get_cluster_cent": [3, 5], "standalon": 3, "segment": [3, 12], "duplic": [3, 5], "code": [3, 5, 9], "custom_nam": 3, "save": 3, "suppress_valid": 3, "_from_color": 3, "_to_color": 3, "pcoord_to_us": 3, "_plot_arg": 3, "along": 3, "rmsd": 3, "flux_": 3, "png": 3, "nwin": 3, "plot_flux_committor_pcoordcolor": 3, "discrep": [3, 12], "alloc": 3, "solv": 3, "poisson": 3, "equat": 3, "math": 3, "h": 3, "1_b": 3, "cdot": 3, "howev": [3, 12], "singular": 3, "instead": [3, 12], "2_2": 3, "volumn": 3, "vector": 3, "indic": 3, "everywher": 3, "els": 3, "solut": 3, "column": 3, "everi": [3, 10], "varianc": [3, 12], "steady_st": 3, "n_desired_we_bin": 3, "mfpt": 3, "strategi": 3, "describ": [3, 12], "integr": 3, "v": 3, "aristoff": 3, "d": 3, "j": 3, "simpson": 3, "g": 3, "webber": 3, "recent": 3, "mathemat": 3, "develop": 3, "get_clustered_mfpt_bin": 3, "optimizedbinmapp": [3, 12], "kwarg": 3, "create_new": 3, "nbin": 3, "n_original_pcoord_dim": 3, "previous_binmapp": 3, "stratified_cluster": [3, 12], "cluster_on_pcoord": 3, "suitabl": 3, "dimens": 3, "user": [3, 11, 12], "suppli": 3, "stratifiedclust": 3, "passag": 3, "adapt": 3, "nmpathanalysi": 3, "packag": [3, 10, 11, 12], "github": [3, 11], "com": 3, "zuckermanlab": 3, "matrixfpt": 3, "base": 3, "classmethod": 3, "mean_fpt": 3, "statea": 3, "stateb": 3, "lag_tim": 3, "calcult": 3, "passav": 3, "deriv": 3, "directional_mfpt": 3, "transition_matrix": [3, 12], "ini_prob": 3, "singl": [3, 12], "direct": [3, 10], "recurs": 3, "procedur": 3, "2d": 3, "mfpts_to_target_microst": 3, "consist": 3, "mfpts_matrix": 3, "ij": 3, "min_commute_tim": 3, "matrix_of_mfpt": 3, "minimum": 3, "commut": 3, "round": 3, "trip": 3, "pair": 3, "involv": 3, "max_commute_tim": 3, "maximum": [3, 12], "fpt_distribut": 3, "t_matrix": 3, "initial_st": 3, "final_st": 3, "initial_distrib": 3, "min_pow": 3, "max_pow": 3, "12": 3, "max_n_lag": 3, "dt": 3, "clean_recycl": 3, "logscal": 3, "final": 3, "power": 3, "shown": 3, "linear": 3, "scale": 3, "max_n_log": 3, "static": 3, "adaptive_fpt_distribut": 3, "initial_state_prob": 3, "target_st": 3, "increment": 3, "fine_incr": 3, "relevant_thresh": 3, "max_step": 3, "1000000": 3, "max_tim": 3, "explicit_renorm": 3, "verbos": 3, "flow": 3, "Then": 3, "coars": 3, "enter": 3, "back": 3, "previou": 3, "swap": 3, "allow": [3, 12], "sweep": 3, "accord": 3, "propag": 3, "through": [3, 12], "track": 3, "strip": 3, "cdf": 3, "across": 3, "amount": 3, "switch": 3, "whether": [3, 12], "explicitli": 3, "renorm": 3, "necessari": 3, "instabl": 3, "care": 3, "evalu": 3, "markovfpt": 3, "markov_tmatrix": 3, "directli": [3, 12], "compar": 3, "forth": 3, "markov_matrix": 3, "markov_commute_tim": 3, "nonmarkovfpt": 3, "nm_transition_matrix": 3, "n_state": 3, "manag": [3, 12], "float32": 3, "trajectory1": 3, "trajectory2": 3, "snapshot": 3, "repres": 3, "evolut": 3, "correspond": [3, 12], "variabl": 3, "add_trajectori": 3, "empirical_mfpt": 3, "count": 3, "empirical_corr_funct": 3, "symmetr": 3, "correl": 3, "pathensembl": 3, "from_ensembl": 3, "map_funct": 3, "discreteensembl": 3, "int32": 3, "en": 3, "from_transition_matrix": 3, "sim_length": 3, "discretepathensembl": 3, "n_path": 3, "1000": 3, "ini_pop": 3, "1000000000": 3, "intiti": 3, "label": [3, 10, 12], "uniform": 3, "c": 3, "explicit": 3, "popul": 3, "nm_mfpt": 3, "weighted_fundamental_sequ": 3, "sort": [3, 12], "fundament": 3, "nonmarkovmodel": 3, "clean_traj": 3, "sliding_window": 3, "revers": 3, "coarse_macrost": 3, "md": 3, "1d": 3, "macrost": 3, "format": 3, "same": [3, 12], "slide": 3, "window": 3, "form": 3, "nm_cmatrix": 3, "cij": 3, "equilibrium": [3, 12], "fit": [3, 12], "from_nm_tmatrix": 3, "corr_funct": 3, "markovpluscolormodel": 3, "hist_length": 3, "plu": 3, "miscellan": 3, "interv": 3, "interval_set": 3, "n_variabl": 3, "half": 3, "union": 3, "n": 3, "len": 3, "f": [3, 12], "reverse_sort_list": 3, "list_1": 3, "list_2": 3, "weighted_choic": 3, "list_": 3, "select": 3, "get_shap": 3, "n_snapshot": 3, "num_of_nonzero_el": 3, "my_vector": 3, "zero": 3, "normalize_markov_matrix": 3, "posit": 3, "divid": 3, "sum": 3, "its": [3, 12], "random_markov_matrix": 3, "seed": 3, "random": 3, "check_tmatrix": 3, "accept_null_row": 3, "stochast": 3, "go": 3, "accept": 3, "problemat": 3, "clean_tmatrix": 3, "rm_absorb": 3, "removed_st": 3, "pops_from_tmatrix": 3, "eigen": 3, "transpos": 3, "p": 3, "pops_from_nm_tmatrix": 3, "real": 3, "transtion": 3, "map_to_integ": 3, "mapping_dict": 3, "intanc": 3, "pseudo_nm_tmatrix": 3, "markovian_tmatrix": 3, "pseudo": 3, "transiton": 3, "john": [4, 11], "russo": [4, 11], "russojd": 4, "ohsu": 4, "edu": 4, "jeremi": [4, 11], "why": 4, "locat": 5, "runner": 5, "work": [5, 12], "docstr": 5, "line": 5, "26": 5, "trp": 6, "cage": 6, "come": 8, "soon": 8, "pre": 9, "releas": 9, "restructur": 9, "repo": 9, "hamsm": [10, 12], "analysi": 10, "natur": 10, "instal": 10, "todo": 10, "credit": 10, "modul": [10, 12], "search": 10, "page": 10, "author": 11, "free": 11, "softwar": 11, "mit": 11, "licens": 11, "jdrusso": 11, "io": 11, "profil": 11, "sometim": 11, "python3": 11, "mayb": 11, "subprocess": 11, "fail": [11, 12], "manifest": 11, "silent": 11, "failur": 11, "hang": 11, "fun": 11, "To": [11, 12], "fix": 11, "upgrad": 11, "overrid": 11, "thei": [11, 12], "someth": 11, "tica": 11, "cookiecutt": 11, "audreyr": 11, "pypackag": 11, "project": [11, 12], "templat": 11, "cd": 12, "conda": 12, "env": 12, "environ": 12, "yml": 12, "basic": 12, "inform": 12, "iterxxx": 12, "script": 12, "collectcoordin": 12, "eventu": 12, "roll": 12, "main": 12, "monkei": 12, "patch": 12, "respons": 12, "trivial": 12, "stuff": 12, "placehold": 12, "level": 12, "itself": 12, "reference_structure_fil": 12, "what": 12, "sound": 12, "variou": 12, "basis_pcoord1_bound": 12, "target_pcoord1_bound": 12, "unit": 12, "aka": 12, "larg": 12, "dataset": 12, "cost": 12, "nomin": 12, "burn": 12, "strongli": 12, "ensur": 12, "good": 12, "grain": 12, "descript": 12, "At": 12, "impli": 12, "addit": 12, "support": 12, "parent": 12, "child": 12, "limit": 12, "earli": 12, "event": 12, "critic": 12, "disconnect": 12, "encount": 12, "difficulti": 12, "happen": 12, "incomplet": 12, "becaus": 12, "criterion": 12, "meaning": 12, "unnecessari": 12, "get_steady_state_algebra": 12, "automat": 12, "don": 12, "know": 12, "slow": 12, "part": 12, "calcul": 12, "invok": 12, "simplest": 12, "whatev": 12, "node": 12, "head": 12, "abov": 12, "wrap": 12, "we_h5filenam": 12, "msm_we_modelnam": 12, "msm_we_n_clust": 12, "outlin": 12, "addition": 12, "goal": 12, "algorithm": 12, "minim": 12, "target_state_indic": 12, "n_active_bin": 12}, "objects": {"msm_we": [[3, 0, 0, "-", "ensembles"], [3, 0, 0, "-", "fpt"], [3, 0, 0, "-", "nmm"], [3, 0, 0, "-", "optimization"], [3, 0, 0, "-", "utils"]], "msm_we.ensembles": [[3, 1, 1, "", "DiscreteEnsemble"], [3, 1, 1, "", "DiscretePathEnsemble"], [3, 1, 1, "", "Ensemble"], [3, 1, 1, "", "PathEnsemble"]], "msm_we.ensembles.DiscreteEnsemble": [[3, 2, 1, "", "from_ensemble"], [3, 2, 1, "", "from_transition_matrix"]], "msm_we.ensembles.DiscretePathEnsemble": [[3, 2, 1, "", "from_ensemble"], [3, 2, 1, "", "from_transition_matrix"], [3, 2, 1, "", "nm_mfpt"], [3, 2, 1, "", "weighted_fundamental_sequences"]], "msm_we.ensembles.Ensemble": [[3, 2, 1, "", "add_trajectory"], [3, 2, 1, "", "empirical_corr_function"], [3, 2, 1, "", "empirical_mfpts"]], "msm_we.ensembles.PathEnsemble": [[3, 2, 1, "", "from_ensemble"]], "msm_we.fpt": [[3, 1, 1, "", "MarkovFPT"], [3, 1, 1, "", "MatrixFPT"], [3, 1, 1, "", "NonMarkovFPT"]], "msm_we.fpt.MarkovFPT": [[3, 2, 1, "", "markov_commute_time"], [3, 2, 1, "", "mean_fpts"]], "msm_we.fpt.MatrixFPT": [[3, 2, 1, "", "adaptive_fpt_distribution"], [3, 2, 1, "", "directional_mfpt"], [3, 2, 1, "", "fpt_distribution"], [3, 2, 1, "", "max_commute_time"], [3, 2, 1, "", "mean_fpts"], [3, 2, 1, "", "mfpts_matrix"], [3, 2, 1, "", "mfpts_to_target_microstate"], [3, 2, 1, "", "min_commute_time"]], "msm_we.fpt.NonMarkovFPT": [[3, 2, 1, "", "mean_fpts"]], "msm_we.msm_we": [[3, 1, 1, "", "modelWE"]], "msm_we.msm_we.modelWE": [[3, 3, 1, "", "build_analyze_model"], [3, 3, 1, "", "cluster_coordinates"], [3, 3, 1, "", "dimReduce"], [3, 3, 1, "", "get_Tmatrix"], [3, 3, 1, "", "get_cluster_centers"], [3, 3, 1, "", "get_committor"], [3, 3, 1, "", "get_coordSet"], [3, 3, 1, "", "get_flux"], [3, 3, 1, "", "get_fluxMatrix"], [3, 3, 1, "", "get_model_clusters"], [3, 3, 1, "", "get_steady_state"], [3, 3, 1, "", "get_steady_state_target_flux"], [3, 3, 1, "", "initialize"], [3, 3, 1, "", "organize_fluxMatrix"], [3, 3, 1, "", "plot_flux"], [3, 3, 1, "", "plot_flux_committor"], [3, 3, 1, "", "plot_flux_committor_pcoordcolor"]], "msm_we.nmm": [[3, 1, 1, "", "MarkovPlusColorModel"], [3, 1, 1, "", "NonMarkovModel"]], "msm_we.nmm.MarkovPlusColorModel": [[3, 2, 1, "", "fit"]], "msm_we.nmm.NonMarkovModel": [[3, 2, 1, "", "corr_function"], [3, 2, 1, "", "empirical_mfpts"], [3, 2, 1, "", "fit"], [3, 2, 1, "", "from_nm_tmatrix"], [3, 4, 1, "", "n_states"], [3, 4, 1, "", "nm_cmatrix"], [3, 4, 1, "", "populations"]], "msm_we.optimization": [[3, 1, 1, "", "OptimizedBinMapper"], [3, 3, 1, "", "get_clustered_mfpt_bins"], [3, 3, 1, "", "get_uniform_mfpt_bins"], [3, 3, 1, "", "solve_discrepancy"]], "msm_we.optimization.OptimizedBinMapper": [[3, 2, 1, "", "create_new"]], "msm_we.utils": [[3, 1, 1, "", "Interval"], [3, 3, 1, "", "check_tmatrix"], [3, 3, 1, "", "clean_tmatrix"], [3, 3, 1, "", "get_shape"], [3, 3, 1, "", "map_to_integers"], [3, 3, 1, "", "normalize"], [3, 3, 1, "", "normalize_markov_matrix"], [3, 3, 1, "", "num_of_nonzero_elements"], [3, 3, 1, "", "pops_from_nm_tmatrix"], [3, 3, 1, "", "pops_from_tmatrix"], [3, 3, 1, "", "pseudo_nm_tmatrix"], [3, 3, 1, "", "random_markov_matrix"], [3, 3, 1, "", "reverse_sort_lists"], [3, 3, 1, "", "weighted_choice"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"trp": [0, 1, 2], "cage": [0, 1, 2], "hamsm": [0, 1, 2, 3, 6, 7], "analysi": [0, 1, 3, 6, 12], "load": [0, 2], "steadi": 0, "state": 0, "committor": 0, "flux": 0, "profil": 0, "cluster": 0, "structur": 0, "construct": [1, 3, 6, 7], "model": [1, 3, 12], "build": [1, 3, 12], "With": 1, "build_analyze_model": 1, "step": 1, "save": 1, "we": 2, "optim": [2, 3, 6, 8, 12], "comput": 2, "discrep": 2, "varianc": 2, "bin": 2, "assign": 2, "each": 2, "msm": 2, "microst": 2, "creat": 2, "optimizedbinmapp": 2, "document": [3, 10], "msm_we": [3, 10, 11], "modelw": 3, "todo": [3, 5, 11], "plot": 3, "fpt": 3, "calcul": 3, "ensembl": 3, "nmm": 3, "util": 3, "credit": [4, 11], "develop": [4, 11], "contributor": 4, "exampl": [6, 7, 8], "histori": 9, "0": 9, "1": 9, "2021": 9, "03": 9, "02": 9, "welcom": 10, "": 10, "content": 10, "indic": 10, "tabl": 10, "featur": 11, "known": 11, "issu": 11, "code": 11, "instal": 12, "usag": 12, "prepar": 12, "stream": 12, "parallel": 12, "one": 12, "command": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.todo": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Trp-cage haMSM Analysis": [[0, "Trp-cage-haMSM-Analysis"]], "Load haMSM": [[0, "Load-haMSM"], [2, "Load-haMSM"]], "Steady-state": [[0, "Steady-state"]], "Committors": [[0, "Committors"]], "Flux profiles": [[0, "Flux-profiles"]], "Cluster structures": [[0, "Cluster-structures"]], "Trp-cage haMSM Construction and Analysis": [[1, "Trp-cage-haMSM-Construction-and-Analysis"]], "Model building": [[1, "Model-building"]], "With build_analyze_model": [[1, "With-build_analyze_model"]], "Step-by-step": [[1, "Step-by-step"]], "Save model": [[1, "Save-model"]], "Trp-cage WE Optimization": [[2, "Trp-cage-WE-Optimization"]], "Compute discrepancy, variance": [[2, "Compute-discrepancy,-variance"]], "Compute WE bin assignments for each MSM microstate": [[2, "Compute-WE-bin-assignments-for-each-MSM-microstate"]], "Create OptimizedBinMapper": [[2, "Create-OptimizedBinMapper"]], "Documentation": [[3, "documentation"]], "haMSM model building and analysis (msm_we.msm_we.modelWE)": [[3, "hamsm-model-building-and-analysis-msm-we-msm-we-modelwe"]], "Construction": [[3, "construction"]], "Todo": [[3, "id1"], [3, "id2"], [3, "id3"], [5, null], [5, null], [5, null]], "Analysis": [[3, "analysis"], [12, "analysis"]], "Plotting": [[3, "plotting"]], "Optimization (msm_we.optimization)": [[3, "module-msm_we.optimization"]], "FPT Calculations": [[3, "fpt-calculations"]], "msm_we.fpt": [[3, "module-msm_we.fpt"]], "msm_we.ensembles": [[3, "module-msm_we.ensembles"]], "msm_we.nmm": [[3, "module-msm_we.nmm"]], "msm_we.utils": [[3, "module-msm_we.utils"]], "Credits": [[4, "credits"], [11, "credits"]], "Development": [[4, "development"]], "Contributors": [[4, "contributors"]], "TODOs": [[5, "todos"]], "Examples": [[6, "examples"]], "haMSM Construction": [[6, "hamsm-construction"]], "haMSM Analysis": [[6, "hamsm-analysis"]], "Optimization": [[6, "optimization"], [12, "optimization"]], "haMSM Construction Examples": [[7, "hamsm-construction-examples"]], "Optimization Examples": [[8, "optimization-examples"]], "History": [[9, "history"]], "0.1.0 (2021-03-02)": [[9, "id1"]], "Welcome to msm_we\u2019s documentation!": [[10, "welcome-to-msm-we-s-documentation"]], "Contents:": [[10, null]], "Indices and tables": [[10, "indices-and-tables"]], "msm_we": [[11, "msm-we"]], "Features": [[11, "features"]], "Known Issues": [[11, "known-issues"]], "Code development TODOs": [[11, "code-development-todos"]], "Installation/Usage": [[12, "installation-usage"]], "Model building and preparation": [[12, "model-building-and-preparation"]], "Streaming": [[12, "streaming"]], "Parallelism": [[12, "parallelism"]], "Model-building, in one command": [[12, "model-building-in-one-command"]]}, "indexentries": {"discreteensemble (class in msm_we.ensembles)": [[3, "msm_we.ensembles.DiscreteEnsemble"]], "discretepathensemble (class in msm_we.ensembles)": [[3, "msm_we.ensembles.DiscretePathEnsemble"]], "ensemble (class in msm_we.ensembles)": [[3, "msm_we.ensembles.Ensemble"]], "interval (class in msm_we.utils)": [[3, "msm_we.utils.Interval"]], "markovfpt (class in msm_we.fpt)": [[3, "msm_we.fpt.MarkovFPT"]], "markovpluscolormodel (class in msm_we.nmm)": [[3, "msm_we.nmm.MarkovPlusColorModel"]], "matrixfpt (class in msm_we.fpt)": [[3, "msm_we.fpt.MatrixFPT"]], "nonmarkovfpt (class in msm_we.fpt)": [[3, "msm_we.fpt.NonMarkovFPT"]], "nonmarkovmodel (class in msm_we.nmm)": [[3, "msm_we.nmm.NonMarkovModel"]], "optimizedbinmapper (class in msm_we.optimization)": [[3, "msm_we.optimization.OptimizedBinMapper"]], "pathensemble (class in msm_we.ensembles)": [[3, "msm_we.ensembles.PathEnsemble"]], "adaptive_fpt_distribution() (msm_we.fpt.matrixfpt static method)": [[3, "msm_we.fpt.MatrixFPT.adaptive_fpt_distribution"]], "add_trajectory() (msm_we.ensembles.ensemble method)": [[3, "msm_we.ensembles.Ensemble.add_trajectory"]], "build_analyze_model() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.build_analyze_model"]], "check_tmatrix() (in module msm_we.utils)": [[3, "msm_we.utils.check_tmatrix"]], "clean_tmatrix() (in module msm_we.utils)": [[3, "msm_we.utils.clean_tmatrix"]], "cluster_coordinates() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.cluster_coordinates"]], "corr_function() (msm_we.nmm.nonmarkovmodel method)": [[3, "msm_we.nmm.NonMarkovModel.corr_function"]], "create_new() (msm_we.optimization.optimizedbinmapper method)": [[3, "msm_we.optimization.OptimizedBinMapper.create_new"]], "dimreduce() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.dimReduce"]], "directional_mfpt() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.directional_mfpt"]], "empirical_corr_function() (msm_we.ensembles.ensemble method)": [[3, "msm_we.ensembles.Ensemble.empirical_corr_function"]], "empirical_mfpts() (msm_we.ensembles.ensemble method)": [[3, "msm_we.ensembles.Ensemble.empirical_mfpts"]], "empirical_mfpts() (msm_we.nmm.nonmarkovmodel method)": [[3, "msm_we.nmm.NonMarkovModel.empirical_mfpts"]], "fit() (msm_we.nmm.markovpluscolormodel method)": [[3, "msm_we.nmm.MarkovPlusColorModel.fit"]], "fit() (msm_we.nmm.nonmarkovmodel method)": [[3, "msm_we.nmm.NonMarkovModel.fit"]], "fpt_distribution() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.fpt_distribution"]], "from_ensemble() (msm_we.ensembles.discreteensemble class method)": [[3, "msm_we.ensembles.DiscreteEnsemble.from_ensemble"]], "from_ensemble() (msm_we.ensembles.discretepathensemble class method)": [[3, "msm_we.ensembles.DiscretePathEnsemble.from_ensemble"]], "from_ensemble() (msm_we.ensembles.pathensemble class method)": [[3, "msm_we.ensembles.PathEnsemble.from_ensemble"]], "from_nm_tmatrix() (msm_we.nmm.nonmarkovmodel class method)": [[3, "msm_we.nmm.NonMarkovModel.from_nm_tmatrix"]], "from_transition_matrix() (msm_we.ensembles.discreteensemble class method)": [[3, "msm_we.ensembles.DiscreteEnsemble.from_transition_matrix"]], "from_transition_matrix() (msm_we.ensembles.discretepathensemble class method)": [[3, "msm_we.ensembles.DiscretePathEnsemble.from_transition_matrix"]], "get_tmatrix() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_Tmatrix"]], "get_cluster_centers() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_cluster_centers"]], "get_clustered_mfpt_bins() (in module msm_we.optimization)": [[3, "msm_we.optimization.get_clustered_mfpt_bins"]], "get_committor() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_committor"]], "get_coordset() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_coordSet"]], "get_flux() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_flux"]], "get_fluxmatrix() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_fluxMatrix"]], "get_model_clusters() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_model_clusters"]], "get_shape() (in module msm_we.utils)": [[3, "msm_we.utils.get_shape"]], "get_steady_state() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_steady_state"]], "get_steady_state_target_flux() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.get_steady_state_target_flux"]], "get_uniform_mfpt_bins() (in module msm_we.optimization)": [[3, "msm_we.optimization.get_uniform_mfpt_bins"]], "initialize() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.initialize"]], "map_to_integers() (in module msm_we.utils)": [[3, "msm_we.utils.map_to_integers"]], "markov_commute_time() (msm_we.fpt.markovfpt class method)": [[3, "msm_we.fpt.MarkovFPT.markov_commute_time"]], "max_commute_time() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.max_commute_time"]], "mean_fpts() (msm_we.fpt.markovfpt class method)": [[3, "msm_we.fpt.MarkovFPT.mean_fpts"]], "mean_fpts() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.mean_fpts"]], "mean_fpts() (msm_we.fpt.nonmarkovfpt class method)": [[3, "msm_we.fpt.NonMarkovFPT.mean_fpts"]], "mfpts_matrix() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.mfpts_matrix"]], "mfpts_to_target_microstate() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.mfpts_to_target_microstate"]], "min_commute_time() (msm_we.fpt.matrixfpt class method)": [[3, "msm_we.fpt.MatrixFPT.min_commute_time"]], "modelwe (class in msm_we.msm_we)": [[3, "msm_we.msm_we.modelWE"]], "module": [[3, "module-msm_we.ensembles"], [3, "module-msm_we.fpt"], [3, "module-msm_we.nmm"], [3, "module-msm_we.optimization"], [3, "module-msm_we.utils"]], "msm_we.ensembles": [[3, "module-msm_we.ensembles"]], "msm_we.fpt": [[3, "module-msm_we.fpt"]], "msm_we.nmm": [[3, "module-msm_we.nmm"]], "msm_we.optimization": [[3, "module-msm_we.optimization"]], "msm_we.utils": [[3, "module-msm_we.utils"]], "n_states (msm_we.nmm.nonmarkovmodel attribute)": [[3, "msm_we.nmm.NonMarkovModel.n_states"]], "nm_cmatrix (msm_we.nmm.nonmarkovmodel attribute)": [[3, "msm_we.nmm.NonMarkovModel.nm_cmatrix"]], "nm_mfpt() (msm_we.ensembles.discretepathensemble method)": [[3, "msm_we.ensembles.DiscretePathEnsemble.nm_mfpt"]], "normalize() (in module msm_we.utils)": [[3, "msm_we.utils.normalize"]], "normalize_markov_matrix() (in module msm_we.utils)": [[3, "msm_we.utils.normalize_markov_matrix"]], "num_of_nonzero_elements() (in module msm_we.utils)": [[3, "msm_we.utils.num_of_nonzero_elements"]], "organize_fluxmatrix() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.organize_fluxMatrix"]], "plot_flux() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.plot_flux"]], "plot_flux_committor() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.plot_flux_committor"]], "plot_flux_committor_pcoordcolor() (in module msm_we.msm_we.modelwe)": [[3, "msm_we.msm_we.modelWE.plot_flux_committor_pcoordcolor"]], "pops_from_nm_tmatrix() (in module msm_we.utils)": [[3, "msm_we.utils.pops_from_nm_tmatrix"]], "pops_from_tmatrix() (in module msm_we.utils)": [[3, "msm_we.utils.pops_from_tmatrix"]], "populations (msm_we.nmm.nonmarkovmodel attribute)": [[3, "msm_we.nmm.NonMarkovModel.populations"]], "pseudo_nm_tmatrix() (in module msm_we.utils)": [[3, "msm_we.utils.pseudo_nm_tmatrix"]], "random_markov_matrix() (in module msm_we.utils)": [[3, "msm_we.utils.random_markov_matrix"]], "reverse_sort_lists() (in module msm_we.utils)": [[3, "msm_we.utils.reverse_sort_lists"]], "solve_discrepancy() (in module msm_we.optimization)": [[3, "msm_we.optimization.solve_discrepancy"]], "weighted_choice() (in module msm_we.utils)": [[3, "msm_we.utils.weighted_choice"]], "weighted_fundamental_sequences() (msm_we.ensembles.discretepathensemble method)": [[3, "msm_we.ensembles.DiscretePathEnsemble.weighted_fundamental_sequences"]]}})